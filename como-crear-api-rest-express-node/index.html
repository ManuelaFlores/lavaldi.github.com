<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.804314511196fa302c97.css">@import url(https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap);@import url(https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&display=swap);
/*! Tania Rascia's website style. Written with plain CSS in one file. Why not? */:root{--font-color:#495057;--heading-color:#343a40;--background:#fff;--dark-font-color:#1b1d25;--medium-font-color:#60656c;--light-font-color:#787f87;--light-background:#f6f8fb;--lighter-background:#e6e8eb;--border:#d6d9de;--link-color:#eb374b;--link-color-darker:#c21327;--navbar-color:#fff;--blockquote:#edf2ff;--transparent-text:rgba(0,0,0,0.7);--transparent-bg:rgba(0,0,0,0.15)}*,:after,:before{box-sizing:border-box}html{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Roboto,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;color:var(--font-color);font-weight:400;font-size:1rem;line-height:1.5}body{background:var(--background);margin:0;padding:0}article{min-width:0}section{margin:2rem 0}section:first-of-type,section>h2{margin-top:0}section>h2{display:flex;align-items:center;font-size:1.8rem;margin-bottom:2rem}.section-button{font-weight:500;background:var(--light-background);color:var(--dark-font-color);padding:.4rem .6rem;font-size:.8rem;border-radius:3rem;border-bottom:0;white-space:nowrap;line-height:1;margin-left:2rem;margin-top:.5rem}.section-button:hover{background:#868e96;color:#fff}@media screen and (min-width:800px){section{margin:3.5rem 0}section>h2{font-size:2rem;margin:0 0 1rem}}.container{max-width:1100px;padding:0 1.5rem;margin-left:auto;margin-right:auto}.container.page p{max-width:600px}@media screen and (min-width:800px){.container{padding:0 2rem}}img{display:inline-block;max-width:100%;height:auto}blockquote,dl,ol,p,table,ul{font-size:1.05rem;margin:0 0 1.5rem}ul{padding:0 1rem}@media screen and (min-width:800px){blockquote,dl,ol,p,table,ul{font-size:1.05rem}ul{padding:0 2rem}}ul li p{margin:0}ul li ul{padding-left:1rem;margin:0}ul li ul li{margin:0}ol li ol{margin-bottom:0}.task-list-item [type=checkbox]{margin-right:.5rem}blockquote{margin:2rem 0;padding:1rem;background:var(--blockquote);border-radius:.35rem;font-weight:400}blockquote p{margin:0}blockquote a{padding:1px 4px}blockquote :not(pre)>code[class*=language-]{background:rgba(0,0,0,.1)!important}blockquote a:hover{border-radius:.35rem;border-bottom:1px solid var(--link-color-darker);background:var(--link-color-darker);color:#fff}blockquote.quotation{margin:2rem 0;padding:0 1.5rem;background:transparent;border-radius:0;border:none;border-left:12px solid var(--border)}blockquote.quotation p{font-family:Georgia,serif;line-height:1.6;color:var(--medium-font-color);font-size:1.1rem;margin:0 0 2rem}blockquote cite{display:block;padding:1rem}blockquote cite p{font-size:1.05rem}blockquote cite{font-size:1.3rem}@media screen and (min-width:800px){blockquote.quotation{margin:2.5rem 0;overflow:auto;border-width:16px}blockquote.quotation cite{float:right}blockquote.quotation p{font-size:1.3rem}}h1,h2,h3,h4,h5{margin:0 0 1.5rem;font-weight:700;line-height:1.2;color:var(--heading-color);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}h1:not(:first-child),h2:not(:first-child),h3:not(:first-child),h4:not(:first-child){margin-top:3rem}h1{font-size:2.5rem;line-height:1.1}h2{font-size:1.75rem;padding-bottom:.5rem;border-bottom:1px solid var(--border)}h2 code{font-size:1.75rem!important}h3{font-size:1.5rem;color:var(--font-color);font-weight:600;margin-bottom:1rem}h3 code{font-size:1.4rem!important}h4{font-size:1.3rem;color:var(--font-color);font-weight:500;border-bottom:1px solid var(--border);padding-bottom:.25rem}h4,h5{margin-bottom:1rem}h5{font-size:1.2rem}@media screen and (min-width:800px){h1{font-size:3rem}h2{font-size:1.8rem}h2 code{font-size:1.8rem!important}h3{font-size:1.6rem;color:var(--font-color);font-weight:600}h3 code{font-size:1.6rem!important}}.aside-content{margin-top:1rem;border-radius:.35rem}aside{min-width:260px}aside a,aside p,aside ul{font-size:.95rem;margin-bottom:0}aside ul{padding-left:1rem}aside h3{margin-top:0;margin-bottom:1rem;padding-bottom:.25rem;font-size:1.1rem;color:var(--dark-font-color);border-bottom:1px solid var(--border)}aside section{margin:1.5rem 0;background:var(--light-background);padding:1.5rem;border-radius:.35rem}.aside-content section:last-child{margin-bottom:0}@media print{.aside-content,aside{display:none}}.avatar{display:block;border-radius:50%;max-width:180px;margin:0 auto 1rem}a.link{display:block;padding:.25rem 0;margin:.25rem 0;border-radius:.35rem;font-weight:600;color:var(--dark-font-color)}a.link,a.link:hover{background:transparent}a.link:hover{color:var(--link-color)}.lead{padding:3rem 0;margin:0;background:var(--background)}.lead .container{display:flex;flex-direction:column}.lead h1{font-weight:600;font-size:1.8rem;margin-bottom:2rem;line-height:1.2}.lead p{color:var(--light-font-color);font-size:1.1rem;font-weight:400;margin-bottom:2.5rem;line-height:1.6}.lead p:last-child{margin-bottom:0}.copy{max-width:600px}.lead img{display:block;border-radius:16px;height:150px;width:150px;margin-bottom:2rem}.lead a{color:var(--link-color);background:transparent;font-weight:700}.lead a:hover{background:linear-gradient(transparent 70%,#f9c2c8 0)}a.button{display:inline-block;border:2px solid var(--link-color);padding:.75rem 1rem;margin-right:.75rem;font-weight:500;background:var(--link-color);color:#fff;border-radius:.35rem;font-size:.9rem}a.button.secondary{border:2px solid #edf2ff;background:#edf2ff;color:#f7394f}a.button.secondary:hover,a.button:hover{border:2px solid var(--link-color-darker);background:var(--link-color-darker);color:#fff}@media screen and (min-width:800px){a.button{padding:1rem 1.5rem;font-size:1.1rem}}.lead .image{order:1}.lead .copy{order:2}.lead b{color:#fff}@media screen and (min-width:800px){.lead{padding:4.5rem 0}.lead .container{flex-direction:row;justify-content:space-between;align-items:center}.lead h1{font-size:2.6rem;line-height:1.1}.lead p{font-size:1.3rem}.lead img{height:auto;width:auto;max-width:200px;margin-bottom:0;margin-left:2.5rem}.lead .image{order:2}.lead .copy{order:1}}@media screen and (min-width:1000px){.lead{align-items:center}.lead img{max-width:350px}}p.subtitle{color:var(--medium-font-color);font-size:1.3rem;font-weight:300}@media screen and (min-width:800px){p.subtitle{font-size:1.5rem}}a{background:linear-gradient(transparent 70%,#f9c2c8 0);text-decoration:none;font-weight:700}a,a:hover{color:var(--dark-font-color)}a:hover{background:linear-gradient(transparent 70%,#e0afb5 0)}.anchor.before{background:none}a.gatsby-resp-image-link:hover{border-bottom:none}a code[class*=language-]{color:var(--link-color)!important}a code[class*=language-]:hover{background:var(--link-color)!important;color:#fff!important}main{margin-top:3.5rem}@media screen and (min-width:800px){main{margin-top:4.5rem}}.emoji{margin:0 .4rem 0 .1rem}.navbar{width:100%;padding:.5rem;position:fixed;top:0;left:0;background:var(--navbar-color);box-shadow:0 3px 13px rgba(100,110,140,.1),0 2px 4px rgba(100,110,140,.15);z-index:2}.navbar .flex{justify-content:space-between}.footer a,.navbar a{background:transparent;border-radius:.35rem;padding:.25rem;margin:0 .05rem;color:#000;font-weight:400;font-size:.9rem;border:1px solid transparent}.navbar a:hover,.navbar a[aria-current=page]{background:rgba(0,0,0,.2);color:#fff}.navbar button{font-size:1rem;margin-right:-1rem}.navbar a .emoji{display:none}.footer a{color:var(--transparent-text)}.footer a:hover{background:var(--transparent-bg)}.navbar a:first-of-type{margin-left:-1rem}.navbar a.brand{font-size:1.05rem;font-weight:500;color:#000;white-space:nowrap;background:transparent;border:none;display:flex;align-items:center;line-height:1}.navbar a.brand:hover{background:rgba(0,0,0,.2)}.navbar a.brand .emoji{display:inline-block!important}.navbar a.brand .name{display:none}@media screen and (min-width:500px){.navbar a{font-size:.95rem;padding:.5rem}.navbar a.brand .name{display:inline}}@media screen and (min-width:800px){.emoji{margin:0 .5rem 0 .1rem}.navbar{padding:.5rem 0}.navbar .flex{justify-content:space-between}.footer a,.navbar a{padding:.75rem 1.25rem;margin:0 .25rem;font-size:1.1rem}.navbar a.brand{font-size:1.3rem;margin-right:3rem;border:none}.navbar a:first-of-type{margin-left:-1.5rem}}@media print{.navbar{display:none}}.footer{padding:2rem 0}.footer>.flex{flex-direction:column}.footer-links,.footer>.flex{align-items:center;justify-content:center}.footer-links{display:flex;flex-wrap:wrap}.flex nav{padding:1rem 0}.footer a.img{display:flex;align-items:center;padding:0;margin:0 .75rem;background:none}.footer img{height:30px;width:30px}@media screen and (min-width:800px){.footer>.flex{align-items:flex-start;margin-left:-1.5rem;margin-right:-1.5rem}.footer a.img{padding:0 .5rem;margin:0 1rem}}@media print{.footer{display:none}}table{display:block;border-collapse:separate;border-spacing:0;width:100%;max-width:100%;overflow-x:auto;border:1px solid var(--border);border-radius:.35rem}tbody,thead{white-space:nowrap}th{border-bottom:2px solid var(--border)}tfoot th{border-top:1px solid var(--light-background)}td{border-bottom:1px solid var(--light-background)}td,th{text-align:left;padding:.75rem!important;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;word-break:break-word}tbody tr:nth-child(2n){background-color:var(--light-background)}@media screen and (min-width:800px){table{display:table}}.flex{display:flex;align-items:center}.flex-row{display:flex;flex-direction:column}@media screen and (min-width:800px){.flex-row{flex-direction:row}}.flex-col{flex:1 1}.flex-two-thirds{flex:2 1}.justify-center{justify-content:center}.new-post{display:inline-block;background:#d3f9d8;color:#111;padding:.5rem;border-radius:.3rem;font-size:.9rem;margin-right:1rem;margin-bottom:1rem}@media screen and (min-width:800px){.new-post{margin-bottom:0}}.grid{display:grid;align-items:stretch}.grid.projects{grid-template-columns:40px auto}.row .cell.description{grid-column:1/span 2;margin-bottom:2rem;line-height:1.3;font-size:1.1rem}@media screen and (min-width:800px){.grid{margin-left:-1rem;margin-right:-1rem}.grid.projects{grid-template-columns:50px 1fr 4fr}.row .cell.description{grid-column:auto;margin-bottom:0}.grid.posts{grid-template-columns:1fr 1fr;grid-gap:.25rem}.grid.lists{grid-template-columns:2fr 4fr}.grid.posts.with-tags{grid-template-columns:4fr 2fr}}.row{display:contents;border-bottom:1px solid var(--border)}a.cell{background:transparent}.lists .row,.posts .row{display:block;margin-bottom:1rem;padding-bottom:1rem}.lists a{background:transparent}.row .cell{font-weight:600;color:var(--dark-font-color);font-size:1.1rem;line-height:1.2;padding:.25rem 0}.row .cell.simple{border-bottom:none}.row .cell time{display:block;font-size:.75rem;margin-bottom:.25rem}@media screen and (min-width:800px){.lists .row,.posts .row{margin-bottom:2rem}.row .cell{display:flex;align-items:center;font-size:1.15rem;padding:.8rem 0}.row.narrow .cell{padding:.4rem 0}.row .cell time{font-size:.8rem}.row .cell.simple{padding:.5rem 0}.lists .row,.posts .row{display:contents}.row:hover>*{background:var(--light-background);border-color:var(--border)}.row .cell.simple:first-child,.row .cell:first-child{padding-left:1rem;border-top-left-radius:.35rem;border-bottom-left-radius:.35rem}.row .cell.simple:last-child,.row .cell:last-child{padding-right:1rem;padding-left:1rem;border-top-right-radius:.35rem;border-bottom-right-radius:.35rem}}.row .cell.light{font-weight:400;color:var(--light-font-color)}.grid.guide{display:block;margin-top:2rem;margin-left:0;margin-right:0}.grid.guide a{display:block;background:var(--light-background);transition:all .2s ease;padding:1.5rem;border-radius:.5rem;margin-bottom:1rem}.grid.guide img{border-radius:.35rem}.grid.guide .gatsby-image-wrapper{height:50px!important;width:50px!important;margin-right:1.5rem}.grid.guide a:hover{transform:translate3D(0,-1px,0);background:var(--lighter-background)}.grid.guide h2{font-size:1.1rem;font-weight:600;padding-bottom:.5rem;margin:.5rem 0 1rem;border-bottom:none}.grid.guide p{font-weight:400;margin:0;line-height:1.5;color:var(--light-font-color)}@media screen and (min-width:600px){.grid.guide{display:grid;grid-auto-rows:1fr;grid-gap:1.5rem;grid-template-columns:repeat(2,minmax(0,1fr))}.grid.guide a{flex-direction:column;justify-content:flex-start;align-items:flex-start;padding:1.5rem;margin:0}.grid.guide .gatsby-image-wrapper{margin-right:0}}@media screen and (min-width:800px){.grid.guide{grid-template-columns:repeat(3,minmax(0,1fr))}.grid.guide a{flex-direction:column}.grid.guide h2{margin-top:.5rem;font-size:1.3rem}.grid.guide .gatsby-image-wrapper{height:75px!important;width:75px!important;margin-right:0}}.grid.post{grid-gap:1rem;margin-left:0;margin-right:0}header{padding:1rem 0}header h1{font-size:2rem;font-weight:600;margin-top:1.5rem}header h1,header u{display:inline-block}header u{text-decoration:none;padding:.4rem 0}.article-header{margin:2rem 0}.article-header .container{padding-left:0;padding-right:0}.article-header .thumb{display:flex;flex-direction:column}.article-header h1{font-weight:700;font-size:1.6rem;margin:0}.article-header .description{font-size:1.5rem;color:var(--light-font-color);font-weight:300;margin-top:2rem;margin-bottom:0}@media screen and (min-width:800px){header h1{font-size:3rem;margin-top:2rem}header u{background:linear-gradient(transparent 85%,#e0afb5 0)}.article-header{margin-top:2.5rem 0}.article-header h1{font-size:2.5rem}.article-header .thumb{flex-direction:row;align-items:center}}@media screen and (min-width:1100px){.grid.post{margin-top:5rem;grid-gap:5rem;grid-template-columns:3fr 1fr}.article-header h1{font-size:2.5rem}}.post-thumbnail{display:block!important}.post-thumbnail.gatsby-image-wrapper{min-width:75px;height:75px!important;width:75px!important;margin-bottom:.5rem}@media screen and (min-width:800px){.post-thumbnail.gatsby-image-wrapper{min-width:100px;height:100px!important;width:100px!important;margin-right:1.5rem;margin-bottom:0}}.search-form{display:flex}[type=search]{display:block;padding:.8rem 1rem;border:1px solid var(--border);width:100%;max-width:400px;border-radius:.35rem;font-size:1rem;-webkit-appearance:none;margin-left:auto;margin-right:auto;margin-bottom:3rem}.search-form [type=search]{border-right:none;border-top-right-radius:0;border-bottom-right-radius:0}::-webkit-input-placeholder{color:var(--light-font-color)}:-moz-placeholder,:-ms-input-placeholder,::-moz-placeholder,::-webkit-input-placeholder,::placeholder{color:var(--light-font-color)}.suggested{flex-direction:column;align-items:stretch;margin-left:-1rem;margin-right:-1rem;padding:0}.suggested span{font-weight:400;display:block;font-size:.9rem;color:var(--transparent-text)}.suggested a{background:none;margin:1rem;border-bottom:none;transition:all .2s ease;padding:1.5rem;border-radius:.35rem;background:var(--light-background)}.suggested a:hover{transform:translate3D(0,-1px,0);background:var(--lighter-background)}@media screen and (min-width:800px){.suggested{flex-direction:row}.suggested a{flex-grow:0;flex-shrink:0;flex-basis:calc(50% - 2rem)}.suggested a:first-of-type{text-align:right}}.small{max-width:600px}.medium{max-width:800px}.meta,time{color:var(--light-font-color);font-size:.9rem;white-space:nowrap;font-weight:400}.meta{color:var(--medium-font-color);font-size:1rem}.count{font-weight:700;color:var(--link-color)}.tags{display:flex!important;flex-wrap:wrap;align-items:center;margin-left:-.5rem;margin-right:-.5rem}.tags>a{display:block;font-weight:500;background:rgba(0,0,0,.1);color:var(--dark-font-color);margin:.2rem;padding:.4rem .6rem;font-size:.8rem;border-radius:16px;border-bottom:0;white-space:nowrap;line-height:1}.tags>a:hover{background:#868e96;color:#fff}mark{background:#ffec99}.text-center{text-align:center}.utterances{margin-left:-4px;margin-right:-4px}kbd{background-color:#f7f7f7;border:2px solid rgba(0,0,0,.3);border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 2px #fff;color:#333;display:inline-block;font-family:Helvetica Neue,Inter,-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif;line-height:1.4;margin:0 .1em;padding:.1em .6em;text-shadow:0 1px 0 #fff;font-size:14px}a.tag-babel,a.tag-javascript,a.tag-naruto,a.tag-sql{background:#fff3bf;color:#000}a.tag-babel:hover,a.tag-javascript:hover,a.tag-naruto:hover,a.tag-sql:hover{background:#ffd43b;color:#000}a.tag-felicidad,a.tag-git,a.tag-html,a.tag-linux,a.tag-snippets{background:#fff4e6;color:#e8590c}a.tag-felicidad:hover,a.tag-git:hover,a.tag-html:hover,a.tag-linux:hover,a.tag-snippets:hover{background:#fd7e14;color:#fff}a.tag-new-year,a.tag-vue{color:#087f5b;background:#e6fcf5}a.tag-new-year:hover,a.tag-vue:hover{background:#0ca678;color:#fff}a.tag-bash,a.tag-terminal{background:#111;color:#d3f9d8}a.tag-bash:hover,a.tag-terminal:hover{background:#fff;color:#37b24d}a.tag-biblia,a.tag-dios,a.tag-github{background:#111;color:#fff}a.tag-biblia:hover,a.tag-dios:hover,a.tag-github:hover{background:#fff;color:#111}a.tag-express,a.tag-fundamentals,a.tag-game,a.tag-node,a.tag-security,a.tag-server,a.tag-testing{background:#d3f9d8;color:#111}a.tag-express:hover,a.tag-fundamentals:hover,a.tag-game:hover,a.tag-node:hover,a.tag-security:hover,a.tag-server:hover,a.tag-testing:hover{background:#37b24d;color:#fff}a.tag-automation,a.tag-cristianismo,a.tag-npm,a.tag-ruby{background:#fff5f5;color:#e03131}a.tag-automation:hover,a.tag-cristianismo:hover,a.tag-npm:hover,a.tag-ruby:hover{background:#f03e3e;color:#fff}a.tag-jQuery,a.tag-notes,a.tag-projects,a.tag-reference,a.tag-wordpress{background:#e3fafc;color:#0c8599}a.tag-jQuery:hover,a.tag-notes:hover,a.tag-projects:hover,a.tag-reference:hover,a.tag-wordpress:hover{background:#1098ad;color:#fff}a.tag-architecture,a.tag-css,a.tag-dom,a.tag-macOS,a.tag-vscode{background:#e7f5ff;color:#1971c2}a.tag-architecture:hover,a.tag-css:hover,a.tag-dom:hover,a.tag-macOS:hover,a.tag-vscode:hover{background:#1c7ed6;color:#fff}a.tag-gatsby,a.tag-life,a.tag-maternidad,a.tag-php,a.tag-redux{background:#f3f0ff;color:#6741d9}a.tag-gatsby:hover,a.tag-life:hover,a.tag-maternidad:hover,a.tag-php:hover,a.tag-redux:hover{background:#7950f2;color:#fff}a.tag-api,a.tag-react,a.tag-tutorial{background:#edf2ff;color:#f7394f}a.tag-api:hover,a.tag-react:hover,a.tag-tutorial:hover{background:#4263eb;color:#fff}a.tag-database,a.tag-design,a.tag-travel{background:#fff0f6;color:#c2255c}a.tag-database:hover,a.tag-design:hover,a.tag-travel:hover{background:#e64980;color:#fff}a.tag-notes,a.tag-perdon,a.tag-tools{background:#f8f0fc;color:#9c36b5}a.tag-notes:hover,a.tag-perdon:hover,a.tag-tools:hover{background:#ae3ec9;color:#fff}#dark-mode-button{display:flex;background:transparent;border:none;padding:.2rem .7rem .2rem .5rem;border-radius:.35rem;box-sizing:content-box;cursor:pointer;font-size:1.1rem}#dark-mode-button:hover{background:var(--transparent-bg)}#dark-mode-button:focus{outline:none}@media screen and (min-width:800px){#dark-mode-button{padding:.75rem}}#comments{margin-top:3rem}#comments h2{margin:0}@media print{#comments,.comments{display:none}}::selection{background:#f7394f;color:#fff}:root{--code-font-family:Menlo,"Roboto Mono",Courier New,monospace;--code-font-color:#b3b9c5;--code-background-color:#353535;--string:#92d192;--variable:#f2777a;--property:#abb2bf;--number:#fca369;--operator:#ac8d58;--punctuation:#d5d8df;--comment:#848991;--function:#62cfcf;--keyword:#ffeead;--attribute:#ffd479;--class:#e1a6f2;--tag:#6ab0f3;--error:#f2777a}code[class*=language-],pre[class*=language-]{-webkit-font-smoothing:subpixel-antialiased;color:var(--code-font-color);font-family:var(--code-font-family);font-size:.9rem;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;font-weight:400;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]>a,code[class*=language-]>a:hover,pre[class*=language-]>a,pre[class*=language-]>a:hover{background:transparent;color:var(--code-font-color);cursor:text;pointer-events:none}pre[class*=language-]{padding:1.5rem;margin:.6rem -1.5rem 2rem;overflow:auto;box-shadow:0 0 1px rgba(0,0,0,.1),0 0 1px rgba(0,0,0,.06),0 2px 2px rgba(0,0,0,.06),0 4px 4px rgba(0,0,0,.06),0 8px 8px rgba(0,0,0,.06),0 16px 16px rgba(0,0,0,.06)}@media screen and (min-width:800px){code[class*=language-],pre[class*=language-]{font-size:.9rem}pre[class*=language-]{padding:1.5rem;margin-left:auto;margin-right:auto;border-radius:.35rem}}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:var(--code-background-color)}:not(pre)>code[class*=language-]{padding:.1rem .3rem;border-radius:.35rem}code.language-text,pre.language-text{background:#dcdee0!important;color:var(--dark-font-color)!important;box-shadow:none}code.language-shell:before{content:"$ ";color:var(--comment)}pre.language-terminal{position:relative;background:#fff;color:#595c62;padding-top:3rem;margin:2rem 0;border-radius:.35rem;border:1px solid #c7c9ca;box-shadow:0 .5rem 1rem rgba(51,51,51,.2),0 .5rem 2rem rgba(51,51,51,.2)}code.language-terminal{color:#595c62}pre.language-terminal:before{content:"\2022   \2022   \2022";position:absolute;top:0;left:0;background:linear-gradient(180deg,#eaeaea,#d2d2d2);color:#b9bcbd;width:100%;font-size:2.5rem;margin:0;line-height:0;padding:15px 0 12px;text-indent:6px;letter-spacing:-18px;border-bottom:1px solid #a6a9aa}pre.language-terminal:after{content:"Output";line-height:1;font-family:Myriad Pro,sans-serif;text-shadow:0 1px 0 hsla(0,0%,100%,.5);font-size:.9rem;position:absolute;top:6px;right:.5rem}.gatsby-highlight-code-line{background-color:#191919;display:block;margin-right:-1rem;margin-left:-1rem;padding-right:1rem;padding-left:.75rem;border-left:.25rem solid #748ffc}.token.cdata,.token.comment,.token.doctype,.token.important,.token.prolog{color:var(--comment)}.token.punctuation{color:var(--punctuation)}.token.namespace{opacity:.7}.token.property{color:var(--property)}.token.constant,.token.deleted,.token.symbol,.token.tag{color:var(--tag)}.token.number{color:var(--number)}.token.builtin,.token.char,.token.inserted,.token.url{color:var(--code-font-color)}.token.attr-name,.token.selector{color:var(--attribute)}.token.attr-value,.token.string{color:var(--string)}.token.operator{color:var(--operator)}.token.atrule,.token.keyword{color:var(--keyword)}.token.function{color:var(--function)}.language-css,.token.boolean,.token.class-name{color:var(--class)!important}.token.regex{color:var(--keyword)}.token.variable{color:var(--variable)}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.filename{font-size:.9rem;margin-bottom:-.8rem;padding:.3rem 1.5rem;line-height:1;font-family:Myriad Pro,sans-serif;background:linear-gradient(180deg,#eaeaea,#d2d2d2);border:1px solid #b9bcbd;color:#4d494d;z-index:2;margin-left:-1.5rem;margin-right:-1.5rem;text-shadow:0 1px 0 hsla(0,0%,100%,.5);box-shadow:inset 0 1px 0 hsla(0,0%,100%,.5),0 1px 0 #515151;text-align:center}@media screen and (min-width:800px){.filename{padding:.3rem 1rem .5rem;border-top-left-radius:.3rem;border-top-right-radius:.3rem;margin-left:auto;margin-right:auto}}code::selection,pre::selection{text-shadow:none;color:inherit;background:hsla(0,0%,58.8%,.3)!important}code[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;color:inherit;background:hsla(0,0%,58.8%,.3)!important}</style><meta name="generator" content="Gatsby 2.24.57"/><title data-react-helmet="true">Cómo crear un API REST con Express.js y Node.js | Claudia Valdivieso</title><link data-react-helmet="true" rel="shortcut icon" type="image/png" href="/static/favicon-c0495cedcf86efc44cf53d77c920070c.png"/><meta data-react-helmet="true" name="description" content="Este tutorial es la parte 3 de 3 en esta serie.
Parte 1: Configuración mínima de Node.js con Babel
Parte 2: ¿Cómo configurar Express.js en…"/><meta data-react-helmet="true" name="image" content="https://lavaldi.com/static/517c02bd875932e2a959488763695b28/92ab1/node.png"/><meta data-react-helmet="true" property="og:url" content="https://lavaldi.com/como-crear-api-rest-express-node/"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Cómo crear un API REST con Express.js y Node.js"/><meta data-react-helmet="true" property="og:description" content="Este tutorial es la parte 3 de 3 en esta serie.
Parte 1: Configuración mínima de Node.js con Babel
Parte 2: ¿Cómo configurar Express.js en…"/><meta data-react-helmet="true" property="og:image" content="https://lavaldi.com/static/517c02bd875932e2a959488763695b28/92ab1/node.png"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="lavaldi_"/><meta data-react-helmet="true" name="twitter:title" content="Cómo crear un API REST con Express.js y Node.js"/><meta data-react-helmet="true" name="twitter:description" content="Este tutorial es la parte 3 de 3 en esta serie.
Parte 1: Configuración mínima de Node.js con Babel
Parte 2: ¿Cómo configurar Express.js en…"/><meta data-react-helmet="true" name="twitter:image" content="https://lavaldi.com/static/517c02bd875932e2a959488763695b28/92ab1/node.png"/><script data-react-helmet="true" type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","url":"https://lavaldi.com","name":"Cómo crear un API REST con Express.js y Node.js","alternateName":"Cómo crear un API REST con Express.js y Node.js"},{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://lavaldi.com/como-crear-api-rest-express-node/","name":"Cómo crear un API REST con Express.js y Node.js","image":"https://lavaldi.com/static/517c02bd875932e2a959488763695b28/92ab1/node.png"}}]},{"@context":"http://schema.org","@type":"BlogPosting","url":"https://lavaldi.com","name":"Cómo crear un API REST con Express.js y Node.js","alternateName":"Cómo crear un API REST con Express.js y Node.js","headline":"Cómo crear un API REST con Express.js y Node.js","image":{"@type":"ImageObject","url":"https://lavaldi.com/static/517c02bd875932e2a959488763695b28/92ab1/node.png"},"description":"Este tutorial es la parte 3 de 3 en esta serie.\nParte 1: Configuración mínima de Node.js con Babel\nParte 2: ¿Cómo configurar Express.js en…"}]</script><link rel="icon" href="/favicon-32x32.png?v=cc3c67583be55729f545c487fe97c776" type="image/png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#eb374b"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=cc3c67583be55729f545c487fe97c776"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=cc3c67583be55729f545c487fe97c776"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=cc3c67583be55729f545c487fe97c776"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=cc3c67583be55729f545c487fe97c776"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=cc3c67583be55729f545c487fe97c776"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=cc3c67583be55729f545c487fe97c776"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=cc3c67583be55729f545c487fe97c776"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=cc3c67583be55729f545c487fe97c776"/><link rel="alternate" type="application/rss+xml" title="Claudia Valdivieso | RSS Feed" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 30)
          }), 0)
        }
      }
    })
  </script><link rel="canonical" href="https://lavaldi.com/como-crear-api-rest-express-node/" data-baseprotocol="https:" data-basehost="lavaldi.com"/><link as="script" rel="preload" href="/webpack-runtime-3eebe46a90198e8d1d5d.js"/><link as="script" rel="preload" href="/framework-0e8501c0599d79803b4b.js"/><link as="script" rel="preload" href="/app-3dea5adc880b0472cc8d.js"/><link as="script" rel="preload" href="/styles-c2fe8482057191dca484.js"/><link as="script" rel="preload" href="/commons-1bb9e007bcab90513ce1.js"/><link as="script" rel="preload" href="/581bf0102f70e897217fa83c9532843e8795dd30-753b011cd44df6005664.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-8d7a448546e0955c0f1a.js"/><link as="fetch" rel="preload" href="/page-data/como-crear-api-rest-express-node/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><nav class="navbar"><div class="container"><div class="flex"><div><a class="brand" href="/"><span class="emoji"><img src="/static/lavaldi-icon-cc3c67583be55729f545c487fe97c776.png" height="30" width="30" alt="La Valdi"/></span> <span class="name">Claudia Valdivieso</span></a></div><div class="flex"><a href="/me">About</a><a href="/code">Code</a><a href="/jesus-freak">Jesus Freak</a><button id="dark-mode-button">🌙</button></div></div></div></nav><main><div class="container"><section class="grid post"><article><header class="article-header"><div class="container"><div class="thumb"><div class="post-thumbnail gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:150px;height:150px"><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAD7klEQVQ4y3VUXUwUVxQeFiM8+eZTH+pL35rGaLWV7Nw7syw1Wgz+pBRrTa1rrD6oEKWttZUHaURgl/11AYmlP1Y2kjQiMSYSk92ZXXaxrGAMtKGJXaK2aVI1WiOyzh7PuTMDo0knOcm9d875zs93zpEk/M6kt0tBTaWjFNVqpS6dl0vWF9ZqXgvqynBQ578HdY/bfg/obElIrxFnv+aW+kZ3SN9n9ktSSK+2dSQ0dHVkVpXROZKqq8D71wj+X2xchUhOEYJvP4R07+u2DTmP6rXW2QyKQMsCurt8EVitR8WZnpseCI1y6NLZcxSDpHvSA+SkC53FtM2VpN+eXlmGNi7buMwB9DamNhLPeyB6XSGgeQsILCmhFEMZDj0m8Aw5X7BPKyZWSPMux1TiQVSM3/DYET13gDgFLCfz0TEFTudVAh7B+q501E7t7595zwYqOgydIEKC6ZfeSH/+zK1qAr2dnR6001YumJ5Eig4gjiRwcAL6kwLUBhbRUp1RbzYxfqDSIkUZoFRRyYxOIwPFEZUCgRSDyBiDo/0MfEdlCGUZvZXQxghnSZcXBm80LTUj1JRE3xTWTmPFYAYNcxw6ku9AQHMLwPbkWiAi4pMMmrsZbPlYhnCOCcGIje6b1E68MDDWVCEAsb8SJy95oK5BLm7fx6B1uAq+yzfA7P08/P3oNzg34YO2q+tg95cMata7oWGfLBztbZGhdpvbOBzBlNO8cH7UAoxPqIlPGlX49HO5+KFPgZ3H3oTph0Pwxz8ZmPrrKtybuw5729+CLR9x2N8qwwc+GY4PMFi/UYZdR7ix5yssjcYLF6cOmYCxX5XEZ8dVaEmwYmNQgT0nVsG12TZ4/PQ+PJl7ALl7fXDk7Gqoq+eUBexqlqHtCoP3t8qw86BZQySm0DvUWGGznIjmsIZISgAJ6bzGoVN7F3651QzD0y3QmVon6vXNzwwOdsqCILq3DuHdLxtdGtYwwws/JpsWAM93T4iGFiwjMSVql/bkGjiVXE31ETULI8uxcbNtkMASMl2K5bkRGRMs3x6cWIzwYt+Ul4yeOkYNW0IphdLqYh9qZqssNDaC4v0ZLQ8M4N8L44eX2pPiQQ9/0nxSe/zPtLw6NWJhmJnxOQyqyVo5TAx0TKurxMcW/PnESt9wzDO8MsfF09ZKQ5tzuM5WEMa3qTfsnaa4FuZa865ApZ9ImYysaA0LcJ7eraiyuBD44l6UzfWHrFrj58WdKC9xLAyORqNkHKZIkIieSbEE7uI/n63nT1eVI7DL2ouS1Juqx/VVLXWk11pAHpdfr3Iu290Icgeje4aRn4roG5bR+xdZQWb55ZFee0lj2TZJLwB1bCjmez/prQAAAABJRU5ErkJggg==" alt="" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/517c02bd875932e2a959488763695b28/92ab1/node.png 1x" /><img loading="lazy" width="150" height="150" srcset="/static/517c02bd875932e2a959488763695b28/92ab1/node.png 1x" src="/static/517c02bd875932e2a959488763695b28/92ab1/node.png" alt="" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><h1>Cómo crear un API REST con Express.js y Node.js</h1></div></div></header><div><blockquote>
<p>Este tutorial es la parte 3 de 3 en esta serie.<br>
Parte 1: <a href="/node-con-babel">Configuración mínima de Node.js con Babel</a><br>
Parte 2: <a href="/configurar-express-en-node">¿Cómo configurar Express.js en Node.js?</a></p>
</blockquote>
<p>Una aplicación Express se usa con más frecuencia como una aplicación backend en una arquitectura cliente-servidor, mientras que el cliente podría escribirse en React.js u otra solución de interfaz popular, el servidor podría escribirse en Express. Ambas entidades dan como resultado una arquitectura cliente-servidor (relación frontend y backend) mientras que el backend sería necesario para la lógica de negocios (A) que no debería ser expuesta como código fuente a la aplicación frontend; de lo contrario, estaría accesible en el navegador, o para (B) establecer conexiones a fuentes de datos de terceros (por ejemplo, bases de datos).</p>
<p>Sin embargo, no confunda la aplicación cliente siempre con el frontend y la aplicación del servidor siempre con el backend aquí. Estos términos no pueden ser intercambiados tan fácilmente. Mientras que una aplicación de interfaz de usuario es generalmente algo que se ve en el navegador, un sistema de fondo generalmente ejecuta una lógica de negocios que no debería estar expuesta en un navegador y, a menudo, también se conecta a una base de datos.</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span></span>Frontend -<span class="token operator">></span> Backend -<span class="token operator">></span> Database</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>Pero, en contraste, los términos cliente y servidor son una cuestión de perspectiva. Una aplicación backend (Backend 1) que consume otra aplicación backend (Backend 2) se convierte repentinamente en una aplicación cliente para la última aplicación de servidor (Backend 2). Sin embargo, la misma aplicación backend (Backend 1) sigue siendo el servidor para otra aplicación cliente que es la aplicación frontend (Frontend).</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript">Frontend <span class="token operator">-</span><span class="token operator">></span> Backend <span class="token number">1</span> <span class="token operator">-</span><span class="token operator">></span> Backend <span class="token number">2</span> <span class="token operator">-</span><span class="token operator">></span> Database

<span class="token comment">// Frontend: Cliente del Backend 1</span>
<span class="token comment">// Backend 1: Servidor para Frontend, también Cliente del Backend 2</span>
<span class="token comment">// Backend 2: Servidor para Backend 1</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Si deseas responder a la pregunta del cliente-servidor si alguien te pregunta qué rol desempeña la entidad en una arquitectura cliente-servidor, siempre pregúntate a ¿quién (servidor) le está sirviendo a quién (cliente) y quién (cliente) consume las funcionalidades de quién (backend)?</p>
<p>Esa es la teoría detrás de las arquitecturas cliente-servidor y cómo relacionarse con ellas. Volvamos a ser más prácticos. ¿Cómo se comunican entre sí las aplicaciones cliente y servidor? A lo largo de los años, existieron algunas interfaces de comunicación (<a href="https://en.wikipedia.org/wiki/Application_programming_interface">APIs</a>) populares entre ambas entidades. Sin embargo, el más popular se llama <a href="https://en.wikipedia.org/wiki/Representational_state_transfer">REST</a> definida en 2000 por Roy Fielding. Es una arquitectura que aprovecha el <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">protocolo HTTP</a> para permitir la comunicación entre un cliente y una aplicación de servidor. Una aplicación de servidor que ofrece una API REST también se denomina servidor RESTful. Los servidores que no siguen la arquitectura REST en un 100% se denominan RESTish en lugar de RESTful. A continuación, vamos a implementar dicha API REST para nuestra aplicación de servidor Express, pero primero vamos a conocer las herramientas que nos permiten interactuar con una API REST.</p>
<h2 id="curl-para-api-rest" style="position:relative;"><a href="#curl-para-api-rest" aria-label="curl para api rest permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cURL para API REST</h2>
<p>Si no has oído hablar de cURL, esta sección te ofrece una breve descripción de qué es cURL y cómo usarlo para interactuar con las API (REST). La definición tomada de <a href="https://en.wikipedia.org/wiki/CURL">Wikipedia</a> dice: "cURL [...] es un proyecto de software informático que proporciona una biblioteca y una herramienta de línea de comandos para transferir datos usando varios protocolos". Dado que REST es una arquitectura que utiliza HTTP, un servidor que expone una API RESTful puede se consumirá con cURL, porque HTTP es uno de los varios protocolos.</p>
<p>Primero, instalémoslo en la línea de comandos. Por ahora, la guía de instalación es para usuarios de MacOS y Ubuntu, pero creo que al buscar "curl para windows" en línea encontrarás una guía de configuración. En esta guía, utilizaremos Homebrew para instalarlo en MacOS. Si no tienes Homebrew, instátelo con el siguiente comando en la línea de comandos:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span></span>/usr/bin/ruby -e <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install<span class="token variable">)</span></span>"</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>A continuación, instale cURL con Homebrew:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span></span>brew <span class="token function">install</span> <span class="token function">curl</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>Para Ubuntu:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span></span><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">curl</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>Ahora, inicia el servidor Express que realizamos en las partes anteriores. Una vez que inicies tu aplicación, ejecuta curl <code class="language-text">http://localhost:3000</code> en otra pestaña de la línea de comandos. Asegúrate de que el puerto coincida con tu puerto y que el servidor Express se esté ejecutando. Después de ejecutar el comando, deberías ver "¡Hola Mundo!" impreso en la línea de comandos. Enhorabuena, acabas de consumir tu servidor Express como cliente con algo más que un navegador.</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token function">Navegador</span> <span class="token punctuation">(</span>Cliente<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Servidor Express
Herramienta de línea de <span class="token function">comandos</span> <span class="token punctuation">(</span>Cliente con cURL<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Servidor Express</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Si accedes a tu aplicación Express en <code class="language-text">http://localhost:3000</code> en el navegador o a través de la línea de comandos con cURL, debería ver el mismo resultado. Ambas herramientas actúan como clientes, mientras que la aplicación Express es su servidor. En las siguientes secciones veremos cómo usar cURL para verificar la API REST de la aplicación Express, que implementaremos en conjunto, en la línea de comandos en lugar de en el navegador.</p>
<h2 id="rutas-express-métodos-http-y-operaciones-rest" style="position:relative;"><a href="#rutas-express-m%C3%A9todos-http-y-operaciones-rest" aria-label="rutas express métodos http y operaciones rest permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Rutas Express: Métodos HTTP y Operaciones REST</h2>
<p>Express es una opción perfecta para un servidor cuando se trata de crear y exponer APIs (por ejemplo, API REST, API GraphQL) para comunicarse como cliente con su aplicación de servidor. <a href="/configurar-express-en-node">Anteriormente</a>, ya había implementado una ruta Express, que envía un "¡Hola mundo!", al que ha accedido a través del navegador y cURL en la línea de comandos. Configuraremos más rutas para acomodar una API RESTful para la aplicación Express eventualmente. Agrega las siguientes rutas a tu aplicación Express, mientras que el URI en sí no cambia, pero el método utilizado sí:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token keyword">import</span> <span class="token string">'dotenv/config'</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
<span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">'express'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Recibió un método GET'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Recibió un método POST'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Recibió un método PUT'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Recibió un método DELETE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">¡Aplicación de ejemplo escuchando en el puerto </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Ahora inicia nuevamente el servidor Express en la línea de comandos, si aún no se está ejecutando, y ejecuta cuatro comandos cURL en otra pestaña de la línea de comandos. Debería ver el siguiente resultado:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span></span><span class="token function">curl</span> http://localhost:3000
-<span class="token operator">></span> Recibió un método GET

<span class="token function">curl</span> -X POST http://localhost:3000
-<span class="token operator">></span> Recibió un método POST

<span class="token function">curl</span> -X PUT http://localhost:3000
-<span class="token operator">></span> Recibió un método PUT

<span class="token function">curl</span> -X DELETE http://localhost:3000
-<span class="token operator">></span> Recibió un método DELETE</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Por defecto cURL usará un método HTTP GET. Sin embargo, puedes especificar el método HTTP con el indicador <code class="language-text">-X</code> (o el indicador <code class="language-text">--request</code>). Dependiendo del método HTTP que elijas, accederá a diferentes rutas de la aplicación Express, que hasta ahora representan solo un único endpoint de la API con un URI hasta el momento. Más adelante verás otras adiciones que puedes agregar a tus solicitudes de cURL.</p>
<p>Ese es uno de los aspectos clave de REST: utiliza métodos HTTP para realizar operaciones en URI(s). A menudo, estas operaciones se denominan <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">operaciones CRUD</a> para crear, leer, actualizar y eliminar operaciones. A continuación, veremos qué estas operaciones se utilizan en las URIs (recursos).</p>
<h2 id="rutas-express-uris-y-recursos" style="position:relative;"><a href="#rutas-express-uris-y-recursos" aria-label="rutas express uris y recursos permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Rutas Express: URIs y recursos</h2>
<p>Otro aspecto importante de REST es que cada URI actúa como un recurso. Hasta ahora, solo hemos operado en la URI raíz con las operaciones CRUD. Realmente no representa un recurso en REST. En contraste, un recurso podría ser un recurso de usuario, por ejemplo:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/users'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Método GET en el recurso usuario'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/users'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Método POST en el recurso usuario'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/users'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Método PUT en el recurso usuario'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/users'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Método DELETE en el recurso usuario'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Con cURL en la línea de comandos, puede recorrer el recurso representado por una URI con diferentes operaciones utilizando nuevamente el endpoint de la API <code class="language-text">http://localhost:3000/users</code>. Verás un resultado similar al anterior, pero esta vez está operando en un recurso llamado usuario. Falta una pieza para que el método HTTP PUT (operación de actualización) y el método HTTP DELETE (operación de eliminación) sean RESTful desde el punto de vista de una URI:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/users'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Método GET en el recurso usuario'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/users'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Método POST en el recurso usuario'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/users/:userId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Método PUT en el recurso usuario/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>userId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/users/:userId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Método DELETE en el recurso usuario/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>userId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Para eliminar o actualizar un recurso de usuario, debe conocer al usuario exacto. Ahí es donde se utilizan identificadores únicos en la programación. En nuestras rutas Express, podemos asignar identificadores únicos con parámetros en la URI. Luego, la función de devolución de llamada mantiene el parámetro en los parámetros del objeto de solicitud. Intenta de nuevo una operación cURL en <code class="language-text">/users/1</code>, <code class="language-text">/users/2</code> u otro identificador con un método HTTP DELETE o UPDATE y verifica que el identificador aparezca en la línea de comandos como salida.</p>
<h2 id="darle-sentido-a-rest" style="position:relative;"><a href="#darle-sentido-a-rest" aria-label="darle sentido a rest permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Darle sentido a REST</h2>
<p>Es posible que aún te estés preguntando: <em>¿Qué valor trae la combinación de URI y métodos HTTP, que constituyen la mayoría de la filosofía REST, a mi aplicación?</em></p>
<p>Imaginemos que no solo devolveremos un resultado, como lo hacemos en este momento, sino que actuaríamos correctamente en la operación recibida en su lugar. Por ejemplo, el servidor Express podría estar conectado a una base de datos que almacena las entidades de los usuarios en una tabla de usuarios. Ahora, cuando consume el API REST como cliente (por ejemplo, cURL, navegador o también una aplicación React.js), puede recuperar todos los usuarios de la base de datos con un método HTTP GET en el URI de <code class="language-text">/users</code> o, en el mismo recurso, crear un nuevo usuario con un método HTTP POST.</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span></span>// Making sense of the Naming

Método de la ruta Express <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">></span> Método HTTP <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">></span> Operación REST
Camino de la ruta Express <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">></span> URI <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">></span> Recurso REST</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>De repente, podrás leer y escribir datos desde y hacia una base de datos desde una aplicación cliente. Todo lo que lo hace posible es una aplicación de back-end que le permite escribir una interfaz (por ejemplo, API REST) ​​para las operaciones CRUD.</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span></span>Cliente -<span class="token operator">></span> API REST -<span class="token operator">></span> Servidor -<span class="token operator">></span> Base de Datos</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>Mientras que es importante notar que la API REST pertenece a la aplicación del servidor. Puede llevar esto siempre un paso más allá al tener varias aplicaciones de servidor que ofrecen API REST. A menudo, vienen con el nombre de microservicios o servicios web, mientras que cada aplicación de servidor ofrece una funcionalidad bien encapsulada. Los servidores ni siquiera tienen que usar el mismo lenguaje de programación, ya que se están comunicando a través de una interfaz independiente del lenguaje de programación. Además, las interfaces (API) no tienen que ser necesariamente API REST.</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span></span>       -<span class="token operator">></span> API REST -<span class="token operator">></span> Servidor -<span class="token operator">></span> API GraphQL -<span class="token operator">></span> Servidor -<span class="token operator">></span> Base de Datos
Cliente
       -<span class="token operator">></span> API REST -<span class="token operator">></span> Servidor -<span class="token operator">></span> Base de Datos</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
<p>Vamos a llevar todo lo que aprendimos en teoría, hasta ahora, un paso más hacia una aplicación real mediante el envío de datos reales a través del cable. Los datos serán datos de muestra, que aún no provendrán de una base de datos, sino que estarán codificados en el código fuente en su lugar:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

<span class="token keyword">let</span> users <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
    username<span class="token operator">:</span> <span class="token string">'Claudia Valdivieso'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>
    username<span class="token operator">:</span> <span class="token string">'Carlos Zárate'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> messages <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
    text<span class="token operator">:</span> <span class="token string">'Hola Mundo'</span><span class="token punctuation">,</span>
    userId<span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>
    text<span class="token operator">:</span> <span class="token string">'Por el Mundo'</span><span class="token punctuation">,</span>
    userId<span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Junto a las entidades de usuario, tendremos entidades de mensaje también. Ambas entidades están relacionadas entre sí al proporcionar la información necesaria como identificadores (por ejemplo, un mensaje tiene un creador del mensaje). Así es como un mensaje se asocia con un usuario y cómo usted también recuperaría los datos de una base de datos, mientras que cada entidad (usuario, mensaje) tiene una tabla de base de datos dedicada. Ambos se representan como objetos a los que se puede acceder mediante identificadores.</p>
<p>Comencemos por proporcionar dos rutas para leer la lista completa de usuarios y un solo usuario por identificador:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

<span class="token keyword">let</span> users <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> messages <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/users'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/users/:userId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>users<span class="token punctuation">[</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>userId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">¡Aplicación de ejemplo escuchando en el puerto </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Mientras que seleccionamos un usuario del objeto por identificador para la ruta de usuarios individuales, transformamos el objeto de usuario en una lista de usuarios para la ruta de todos los usuarios. Lo mismo debería ser posible para el recurso de mensaje:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

<span class="token keyword">let</span> users <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> messages <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/messages'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>messages<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/messages/:messageId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>messages<span class="token punctuation">[</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>messageId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">¡Aplicación de ejemplo escuchando en el puerto </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Pruebe las cuatro rutas con cURL en la línea de comandos. Sólo se trata de leer datos. A continuación, analizaremos las otras operaciones de CRUD para crear, actualizar y eliminar recursos para escribir datos en realidad. Sin embargo, no podremos evitar un middleware Express personalizado y un middleware Express proporcionado por el ecosistema. Es por eso que discutiremos el tema del middleware Express a continuación mientras implementamos las operaciones CRUD que faltan.</p>
<h2 id="express-middleware" style="position:relative;"><a href="#express-middleware" aria-label="express middleware permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Express Middleware</h2>
<p>Veamos cómo se puede implementar un escenario para crear un mensaje en nuestra aplicación Express. Ya que estamos creando un mensaje sin una base de datos, necesitamos una biblioteca auxiliar para generar identificadores únicos para nosotros. Instale esta biblioteca auxiliar desde la línea de comandos:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span></span><span class="token function">npm</span> <span class="token function">install</span> uuid</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>Luego, impórtelo en la parte superior de su archivo <code class="language-text">src/index.js</code>:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token keyword">import</span> uuidv4 <span class="token keyword">from</span> <span class="token string">'uuid/v4'</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>Ahora, cree un mensaje con una nueva ruta que use un método HTTP POST:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/messages'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">uuidv4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  messages<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> message<span class="token punctuation">;</span>

  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Generamos un identificador único para el mensaje con la nueva biblioteca, lo usamos como propiedad en un objeto de mensaje, asignamos el mensaje por identificador en el objeto de mensajes, que es nuestra pseudo base de datos, y devolvemos el nuevo mensaje después de que se haya creado.</p>
<p>Sin embargo, falta algo para el mensaje. Para crear un mensaje, un cliente debe proporcionar la cadena de texto para el mensaje. Afortunadamente, un método HTTP POST permite enviar datos como carga útil en un cuerpo. Es por eso que podemos usar la solicitud entrante (<code class="language-text">req</code>) para extraer una carga útil de la misma.</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/messages'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">uuidv4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">,</span>
    text<span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>text<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  messages<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> message<span class="token punctuation">;</span>

  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Sin embargo, el acceso directo a la carga útil de una solicitud HTTP POST de esta manera no lo proporciona Express fuera de la caja. O bien, tendría que transformar la carga útil del cuerpo usted mismo o utilizar un middleware dedicado para que esta transformación se realice por usted. Instale y use un middleware conocido para este propósito:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span></span><span class="token function">npm</span> <span class="token function">install</span> body-parser</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>A continuación, úselo para su aplicación Express como middleware:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>
<span class="token keyword">import</span> bodyParser <span class="token keyword">from</span> <span class="token string">'body-parser'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">'express'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>El body-parser extrae toda la parte del cuerpo de un flujo de solicitud entrante y lo hace accesible en <code class="language-text">req.body</code> (<a href="https://www.quora.com/What-exactly-does-body-parser-do-with-express-js-and-why-do-I-need-it">Fuente</a>):</p>
<ul>
<li>bodyParser.json(): analiza el texto como JSON y expone el objeto resultante en <code class="language-text">req.body</code>.</li>
<li>bodyParser.urlencoded(): analiza el texto como datos codificados en la URL (que es la forma en que los navegadores tienden a enviar datos de formularios de los formularios normales establecidos a POST) y expone el objeto resultante (que contiene las claves y los valores) en <code class="language-text">req.body</code>.</li>
</ul>
<p>Ahora se puede acceder al cuerpo con el texto del mensaje en la solicitud si se envía mediante una solicitud POST normal o una solicitud POST desde un formulario HTML. Ambas formas deberían funcionar ahora. Todos los datos se deben recibir y enviar como carga JSON ahora. Ese es otro aspecto de REST, que en sí mismo no tiene un formati estándar para la carga útil (JSON, XML), pero una vez que hayas elegido un formato, debe atenerse a él para la API completa.</p>
<p>En los últimos pasos, hemos instalado un nuevo middleware para Express y lo hemos puesto a disposición en un nivel de aplicación. Cada solicitud que llega a una de nuestras rutas Express pasa por el middleware. Por lo tanto, todos los datos enviados por un cliente a nuestro servidor están disponibles en la solicitud entrante. Inténtalo creando un mensaje tú mism@. En una solicitud de cURL puede especificar encabezados HTTP con el indicador <code class="language-text">-H</code>, es decir, como decimos que queremos transferir JSON, y los datos como carga útil con el indicador <code class="language-text">-d</code>. Deberías poder crear mensajes de esta manera:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span></span><span class="token function">curl</span> -X POST -H <span class="token string">"Content-Type:application/json"</span> http://localhost:3000/messages -d <span class="token string">'{"text":"Hola de nuevo, Mundo"}'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>Hasta ahora, solo hemos importado middleware de terceros y lo hemos utilizado en un nivel de aplicación. Ahora, construyamos un middleware Express personalizado, que se utiliza en un nivel de aplicación, nosotros mismos. El modelo para un middleware es similar a las funciones Express que hemos visto antes:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// hacer algo</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>La función <code class="language-text">next()</code>, que está disponible como tercer argumento, se llama para indicar que el middleware ha finalizado su trabajo. Esto se vuelve más importante cuando su middleware utiliza funciones asíncronas. En medio de la función de middleware puedes hacer cualquier cosa ahora. Podríamos simplemente realizar un <code class="language-text">console.log()</code> de la hora o hacer algo con la solicitud (<code class="language-text">req</code>) o la respuesta (<code class="language-text">res</code>). En nuestro caso, para crear un mensaje, necesitamos saber de alguna manera quién está creando el mensaje. Hagamos una versión simple de un middleware que determine a un pseudo usuario "autenticado" que envía la solicitud. Entonces es posible agregar a este usuario como creador de mensajes al mensaje:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  req<span class="token punctuation">.</span>me <span class="token operator">=</span> users<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/messages'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">uuidv4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">,</span>
    text<span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>text<span class="token punctuation">,</span>
    userId<span class="token operator">:</span> req<span class="token punctuation">.</span>me<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  messages<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> message<span class="token punctuation">;</span>

  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>De repente tendremos acceso al usuario <code class="language-text">me</code> en el objeto de solicitud, que es el usuario autenticado, en nuestras rutas. Este usuario puede ser usado luego para ser asignado como creador del mensaje. Se puede imaginar cómo ese middleware podría usarse más adelante para interceptar cada solicitud entrante para determinar a partir de los encabezados HTTP entrantes si la solicitud proviene de un usuario autenticado o no. Si la solicitud proviene de un usuario autenticado, el usuario se propaga a todas las rutas Express que se utilizarán allí. Así es como el servidor Express puede ser sin estado, mientras que un cliente siempre envía la información del usuario autenticado actualmente.</p>
<p>Ser sin estado (stateless) es otra característica de los servicios REST. Después de todo, debería ser posible crear múltiples instancias de servidor para equilibrar el tráfico entrante de manera uniforme entre los servidores. Si escuchó sobre el término balanceador de carga anteriormente, eso es exactamente lo que se usa cuando tiene varios servidores a su disposición. Es por eso que un servidor no puede mantener el estado (por ejemplo, un usuario autenticado) y el cliente siempre tiene que enviar esta información junto con cada solicitud. Luego, un servidor puede tener un middleware que se encarga de la autenticación en un nivel de aplicación y proporciona el estado de la sesión (por ejemplo, un usuario autenticado) a cada ruta en su aplicación Express.</p>
<p>Ahora que hemos aprendido lo esencial sobre el middleware de nivel de aplicación en Express, implementemos las últimas rutas para completar las rutas de nuestra aplicación. ¿Qué pasa con la operación para eliminar un mensaje:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/messages/:messageId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>messageId<span class="token punctuation">]</span><span class="token operator">:</span> message<span class="token punctuation">,</span>
    <span class="token operator">...</span>otherMessages
  <span class="token punctuation">}</span> <span class="token operator">=</span> messages<span class="token punctuation">;</span>

  messages <span class="token operator">=</span> otherMessages<span class="token punctuation">;</span>

  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Puedes probarlo con el siguiente comando cURL:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span></span><span class="token function">curl</span> -X DELETE http://localhost:3000/messages/1</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>La operación de actualización en un recurso de mensaje es para que lo implementes como un ejercicio. Lo dejaré para una sección posterior, porque rápidamente plantea un nuevo tema: los permisos. La pregunta: ¿Quién puede editar un mensaje? Solo debería ser posible para el usuario autenticado (<code class="language-text">me</code>) que es el creador del mensaje, ¿verdad?</p>
<p>Por último, como ya tienes a tu disposición el pseudo usuario autenticado debido al middleware de toda la aplicación, también puede ofrecer una ruta dedicada para este recurso:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/session'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>users<span class="token punctuation">[</span>req<span class="token punctuation">.</span>me<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Es la primera vez que rompe las reglas de ser completamente REST, porque se ofrece un endpoint de API para una característica muy específica. No será la primera vez que infrinja las leyes de REST, porque la mayoría de las veces REST no se implementa por completo, sino RESTish. Si quieres profundizar más en REST, hazlo!.</p>
<h2 id="modelos-modulares-en-express-como-fuentes-de-datos" style="position:relative;"><a href="#modelos-modulares-en-express-como-fuentes-de-datos" aria-label="modelos modulares en express como fuentes de datos permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Modelos modulares en Express como fuentes de datos</h2>
<p>En este momento, toda nuestra implementación se encuentra en el archivo <code class="language-text">src/index.js</code>. Sin embargo, en algún momento es posible que desees modularizar los detalles de su implementación y colocarlos en archivos y carpetas dedicados, mientras que el archivo <code class="language-text">src/index.js</code> solo debe preocuparse de poner todo junto e iniciar la aplicación. Antes de sumergirnos en modularizar el enrutamiento, veamos cómo podemos modularizar nuestros datos de muestra primero en los llamados modelos. Desde su carpeta <code class="language-text">src</code> escriba los siguientes comandos para crear una estructura de carpeta/archivo para los modelos.</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="command-line-prompt"><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span><span data-user=root data-host=localhost></span></span><span class="token function">mkdir</span> models
<span class="token builtin class-name">cd</span> models
<span class="token function">touch</span> index.js</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
<p>La carpeta modelos en una aplicación Express suele ser el lugar donde define sus fuentes de datos. En nuestro caso, son los datos de muestra, pero en otras aplicaciones, por ejemplo, serían las interfaces a la base de datos. En nuestro caso de refactorización, movamos nuestros datos de muestra al nuevo archivo <code class="language-text">src/models/index.js</code>:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token keyword">let</span> users <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
    username<span class="token operator">:</span> <span class="token string">'Claudia Valdivieso'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>
    username<span class="token operator">:</span> <span class="token string">'Carlos Zárate'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> messages <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
    text<span class="token operator">:</span> <span class="token string">'Hola Mundo'</span><span class="token punctuation">,</span>
    userId<span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>
    text<span class="token operator">:</span> <span class="token string">'Por el Mundo'</span><span class="token punctuation">,</span>
    userId<span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  users<span class="token punctuation">,</span>
  messages<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Elimine los datos de muestra posteriormente en el archivo <code class="language-text">src/index.js</code>. También importe los modelos en el archivo<code class="language-text">src/index.js</code> ahora y páselos en nuestro middleware personalizado de nivel de aplicación a todas las rutas a través de un objeto de contexto dedicado. Ahí es donde el usuario <code class="language-text">me</code> (autenticado) puede colocarse también. No necesita necesariamente el objeto de contexto como contenedor, pero me pareció una buena práctica mantener todo lo que se pasa a las rutas en un solo lugar.</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

<span class="token keyword">import</span> models <span class="token keyword">from</span> <span class="token string">'./models'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  req<span class="token punctuation">.</span>context <span class="token operator">=</span> <span class="token punctuation">{</span>
    models<span class="token punctuation">,</span>
    me<span class="token operator">:</span> models<span class="token punctuation">.</span>users<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Luego, en lugar de tener acceso a los datos de muestra en todas las rutas desde variables externas como antes, lo cual es un efecto secundario innecesario y no mantiene la función pura, queremos usar los modelos (y el usuario autenticado) desde los argumentos de la función ahora.</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/session'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>users<span class="token punctuation">[</span>req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>me<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/users'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>users<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/users/:userId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>users<span class="token punctuation">[</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>userId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/messages'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>messages<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/messages/:messageId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>messages<span class="token punctuation">[</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>messageId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/messages'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">uuidv4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">,</span>
    text<span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>text<span class="token punctuation">,</span>
    userId<span class="token operator">:</span> req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>me<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>messages<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> message<span class="token punctuation">;</span>

  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/messages/:messageId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>messageId<span class="token punctuation">]</span><span class="token operator">:</span> message<span class="token punctuation">,</span>
    <span class="token operator">...</span>otherMessages
  <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>messages<span class="token punctuation">;</span>

  req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>messages <span class="token operator">=</span> otherMessages<span class="token punctuation">;</span>

  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Estamos utilizando el middleware de toda la aplicación para pasar los modelos a todas nuestras rutas en un objeto de contexto. Los modelos viven fuera del archivo <code class="language-text">src/index.js</code> y pueden ser refactorizados a las interfaces reales de la base de datos. A continuación, dado que hicimos que el enrutamiento fuera independiente de todos los efectos secundarios y pasáramos todo lo necesario a través del objeto de solicitud con el objeto de contexto, también podemos mover las rutas a lugares separados.</p>
<h2 id="enrutamiento-modular-con-express-router" style="position:relative;"><a href="#enrutamiento-modular-con-express-router" aria-label="enrutamiento modular con express router permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enrutamiento modular con Express Router</h2>
<p>Hasta ahora, hemos montado rutas directamente en la instancia de la aplicación Express en el archivo <code class="language-text">src/index.js</code>. Esto se volverá prolijo con el tiempo, ya que este archivo solo debe preocuparse por todos los temas importantes para iniciar nuestra aplicación. No debe revelar detalles de implementación de las rutas. Ahora la mejor práctica sería mover las rutas a una estructura de carpetas/archivos dedicados. Es por eso que queremos darle a cada recurso REST su propio archivo en una carpeta dedicada. Desde su carpeta <code class="language-text">src/</code>, escriba lo siguiente en la línea de comandos para crear una estructura de carpeta/archivo para las rutas modulares:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token operator">...</span>

<span class="token keyword">import</span> routes <span class="token keyword">from</span> <span class="token string">'./routes'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/session'</span><span class="token punctuation">,</span> routes<span class="token punctuation">.</span>session<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/users'</span><span class="token punctuation">,</span> routes<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/messages'</span><span class="token punctuation">,</span> routes<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>En nuestro archivo de entrada <code class="language-text">src/route/index.js</code> al módulo de rutas, importe todas las rutas desde sus archivos dedicados (que aún no están definidos) y expórtelos como un objeto. Después, están disponibles en el archivo <code class="language-text">src/index.js</code> como ya los hemos usado.</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token keyword">import</span> session <span class="token keyword">from</span> <span class="token string">'./session'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> user <span class="token keyword">from</span> <span class="token string">'./user'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> message <span class="token keyword">from</span> <span class="token string">'./message'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  session<span class="token punctuation">,</span>
  user<span class="token punctuation">,</span>
  message<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Ahora implementemos cada ruta modular. Comience con la ruta de la sesión en el archivo <code class="language-text">src/route/session.js</code> que solo devuelve el pseudo usuario autentificado. Express ofrece Express Router para crear dichas rutas modulares sin montarlas directamente en la instancia de la aplicación Express. Así es como podemos crear rutas modulares en otros lugares que no sean la aplicación Express, pero importarlos más tarde para que se monten en la instancia de la aplicación Express como ya lo hemos hecho en un paso anterior.</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Router <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'express'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>users<span class="token punctuation">[</span>req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>me<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>A continuación, la ruta user en el archivo <code class="language-text">src/route/user.js</code>. Es bastante similar a la ruta de la sesión:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Router <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'express'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>users<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/:userId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>users<span class="token punctuation">[</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>userId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Observe que no necesitamos definir la URI <code class="language-text">/users</code> (ruta) sino solo las subrutas, porque ya lo hicimos en el proceso de montaje de la ruta en la aplicación Express (checa el archivo <code class="language-text">src/index.js</code>). A continuación, implemente el archivo <code class="language-text">src/route/message.js</code> para definir la última de nuestras rutas modulares:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token keyword">import</span> uuidv4 <span class="token keyword">from</span> <span class="token string">'uuid/v4'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Router <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'express'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>messages<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/:messageId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>messages<span class="token punctuation">[</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>messageId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">uuidv4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">,</span>
    text<span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>text<span class="token punctuation">,</span>
    userId<span class="token operator">:</span> req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>me<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>messages<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> message<span class="token punctuation">;</span>

  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/:messageId'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>messageId<span class="token punctuation">]</span><span class="token operator">:</span> message<span class="token punctuation">,</span>
    <span class="token operator">...</span>otherMessages
  <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>messages<span class="token punctuation">;</span>

  req<span class="token punctuation">.</span>context<span class="token punctuation">.</span>models<span class="token punctuation">.</span>messages <span class="token operator">=</span> otherMessages<span class="token punctuation">;</span>

  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Ahora cada una de nuestras rutas modulares desde Express Router está montada en nuestra aplicación Express con una URI dedicada en el archivo <code class="language-text">src/index.js</code>. Las rutas modulares en la carpeta <code class="language-text">src/route</code> solo se ocupan de las rutas secundarias y los detalles de implementación, mientras que el archivo <code class="language-text">src/index.js</code> se ocupa de la ruta principal y la ruta modular que se usa allí. Al final, no olvides eliminar todas las rutas utilizadas anteriormente del archivo <code class="language-text">src/index.js</code> que movimos a la carpeta <code class="language-text">src/route/</code>.</p>
<h3 id="recursos-relacionados" style="position:relative;"><a href="#recursos-relacionados" aria-label="recursos relacionados permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Recursos relacionados</h3>
<p><a href="https://www.toptal.com/express-js/nodejs-typescript-rest-api-pt-1">Building a Node.js/TypeScript REST API, Part 1: Express.js</a> es un tutorial (en inglés) para aquellos que desean usar TypeScript y en él usa un paquete interesante llamado <code class="language-text">winston</code> que es responsable de registrar (log) las peticiones a nuestra API y las respuestas (y errores) devueltas 👌.</p>
<blockquote>
<p>Este tutorial es la parte 3 de 3 en esta serie.<br>
Parte 1: <a href="/node-con-babel">Configuración mínima de Node.js con Babel</a><br>
Parte 2: <a href="/configurar-express-en-node">¿Cómo configurar Express.js en Node.js?</a></p>
</blockquote></div><div id="comments"><h2>Comment or let&#x27;s <a href="https://mobile.twitter.com/search?q=https%3A%2F%2Flavaldi.com%2Fcomo-crear-api-rest-express-node" target="_blank" rel="noopener noreferrer">discuss on Twitter</a></h2><div id="disqus_thread"></div></div></article><aside><div class="aside-content"><section><img src="/static/lavaldi-8926e428d8d1d0bbb0ca41096e3ec873.jpg" alt="Claudia Valdivieso" class="avatar"/><p>I&#x27;m Claudia, christian, wife, mother and a software engineer, and sometimes I write about christianity and programming.</p></section><section><h3>Tags</h3><div class="cell tags"><a class="tag-node" href="/tags/node">node</a><a class="tag-babel" href="/tags/babel">babel</a><a class="tag-express" href="/tags/express">express</a></div></section><section><h3>Published</h3><time>February 09, 2019</time></section><section><h3>Stay in touch</h3><nav><a href="https://twitter.com/lavaldi_" target="_blank" rel="noreferrer" class="link"><span class="emoji">🐦</span> Twitter: @lavaldi_</a><a href="https://github.com/lavaldi" target="_blank" rel="noreferrer" class="link"><span class="emoji">🐙</span> GitHub: @lavaldi</a><a target="_blank" rel="noreferrer" class="link" href="/rss.xml"><span class="emoji">☢️</span> RSS feed</a></nav></section></div></aside></section><nav class="flex container suggested"><a rel="prev" href="/configurar-express-en-node/"><span>Previous</span>¿Cómo configurar Express.js en Node.js?</a><a rel="next" href="/una-vision-para-semana-santa/"><span>Next</span>Una visión para semana santa</a></nav></div></main><footer class="footer flex"><section class="container"><nav class="footer-links"><a href="/code">Code</a><a href="/jesus-freak">Jesus Freak</a><a href="https://twitter.com/lavaldi" target="_blank" rel="noopener noreferrer">Twitter</a><a href="/rss.xml">RSS</a></nav><nav class="flex justify-center">With ❤️</nav></section></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/como-crear-api-rest-express-node/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-de20a57117afe68a35b4.js"],"app":["/app-3dea5adc880b0472cc8d.js"],"component---src-pages-404-js":["/component---src-pages-404-js-95fb52f08ed3958042d9.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-1949edeabcba6df87701.js"],"component---src-pages-code-js":["/component---src-pages-code-js-2ce3048b3bb0b263605f.js"],"component---src-pages-index-js":["/component---src-pages-index-js-5d3f3bad77a5ce9309bc.js"],"component---src-pages-jesus-freak-js":["/component---src-pages-jesus-freak-js-ffebf312adb411d12257.js"],"component---src-templates-page-js":["/component---src-templates-page-js-6778861fcde099cd3630.js"],"component---src-templates-post-js":["/component---src-templates-post-js-8d7a448546e0955c0f1a.js"],"component---src-templates-tag-js":["/component---src-templates-tag-js-3a375f66c550197b7f43.js"]};/*]]>*/</script><script src="/polyfill-de20a57117afe68a35b4.js" nomodule=""></script><script src="/component---src-templates-post-js-8d7a448546e0955c0f1a.js" async=""></script><script src="/581bf0102f70e897217fa83c9532843e8795dd30-753b011cd44df6005664.js" async=""></script><script src="/commons-1bb9e007bcab90513ce1.js" async=""></script><script src="/styles-c2fe8482057191dca484.js" async=""></script><script src="/app-3dea5adc880b0472cc8d.js" async=""></script><script src="/framework-0e8501c0599d79803b4b.js" async=""></script><script src="/webpack-runtime-3eebe46a90198e8d1d5d.js" async=""></script></body></html>